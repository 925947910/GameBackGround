<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yxb.cms.dao.GameUserMapper">
	<resultMap id="BaseResultMap"
		type="com.yxb.cms.domain.vo.gameUser">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Aug 15 
			22:46:30 CST 2016. -->
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="acc" property="acc" jdbcType="VARCHAR" />
		<result column="pwd" property="pwd" jdbcType="VARCHAR" />
		<result column="plat" property="plat" jdbcType="INTEGER" />
		<result column="nick" property="nick" jdbcType="VARCHAR" />
		<result column="phone" property="phone" jdbcType="VARCHAR" />
		<result column="sex" property="sex" jdbcType="INTEGER" />
		<result column="photo" property="photo" jdbcType="VARCHAR" />
		<result column="freezed" property="freezed" jdbcType="INTEGER" />
		<result column="isTourist" property="isTourist" jdbcType="INTEGER" />
		<result column="isLeader" property="isLeader" jdbcType="INTEGER" />
		<result column="coin" property="coin" jdbcType="INTEGER" />
		<result column="agentId" property="agentId" jdbcType="INTEGER" />
		<result column="presenterId" property="presenterId" jdbcType="INTEGER" />
		<result column="regTime" property="regTime" jdbcType="BIGINT" />
		<result column="version" property="version" jdbcType="INTEGER" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Aug 15 
			22:46:30 CST 2016. -->
		 *
	</sql>

	<!-- 查询用户总记录数 -->
	<select id="selectCountUser"
		parameterType="com.yxb.cms.domain.vo.gameUser" resultType="Long">
		select count(*)
		from gameuser
		<include refid="selectPageParmas" />
	</select>
	<!-- 用户列表信息分页显示 -->
	<select id="selectUserListByPage"
		parameterType="com.yxb.cms.domain.vo.gameUser"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from gameuser 
		<include refid="selectPageParmas" />
		order by regTime DESC
		LIMIT #{start},#{limit}
	</select>

	<!-- 用户列表信息List -->
	<select id="selectUserList"
		parameterType="com.yxb.cms.domain.vo.gameUser"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from gameuser
		<include refid="selectPageParmas" />

	</select>
	<!-- 分页查询条件 -->
	<sql id="selectPageParmas">
		<where>
			<if
				test="searchTerm != null and searchTerm != '' and searchContent != null and  searchContent != '' and  searchTerm == 'idTerm' ">
				AND id= #{searchContent,jdbcType=VARCHAR}
			</if>
			<if
				test="searchTerm != null and searchTerm != '' and searchContent != null and  searchContent != '' and  searchTerm == 'accTerm' ">
				AND acc LIKE CONCAT('%', #{searchContent,jdbcType=VARCHAR},
				'%')
			</if>
			<if
				test="searchTerm != null and searchTerm != '' and searchContent != null and  searchContent != '' and  searchTerm == 'nickTerm' ">
				AND nick LIKE CONCAT('%', #{searchContent,jdbcType=VARCHAR},
				'%')
			</if>
			<if
				test="searchTerm != null and searchTerm != '' and searchContent != null and  searchContent != '' and  searchTerm == 'agentIdTerm' ">
			    AND agentId= #{searchContent,jdbcType=INTEGER}
			</if>
			
			<if
				test="searchTerm1 != null and searchTerm1 != '' and searchContent1 != null and  searchContent1 != '' and  searchTerm1 == 'agentIdTerm' ">
				AND agentId= #{searchContent1,jdbcType=INTEGER}
			</if>
		</where>
	</sql>
	
	<update id="coinChange">
		update gameuser set
		coin=#{coin,jdbcType=INTEGER},version=#{version,jdbcType=INTEGER}+1
		where id=#{id,jdbcType=INTEGER} and
		version=#{version,jdbcType=INTEGER}
	</update>
	
	<update id="userFreeze">
		update gameuser set freezed = #{freeze,jdbcType=INTEGER}  where id=#{id,jdbcType=INTEGER}
	</update>
	
	<update id="updatePwd">
	update gameuser set
	<if test="pwd != null and pwd != '' ">
	    pwd=#{pwd,jdbcType=VARCHAR}
	</if>
	   where id=#{id,jdbcType=INTEGER}
	</update>


	<select id="checkCoin" resultMap="BaseResultMap">
		select agentId,coin,version,isTourist,nick FROM
		gameuser where id=#{id,jdbcType=INTEGER}
	</select>





</mapper>